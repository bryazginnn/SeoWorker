<div class="container" ng-controller="SitesCtrl as vm">
    <div class="alerts-container"></div>
    <div class="col-xs-4">
        <span ng-show="vm.loading" class="spinner"></span>

        <div class="panel panel-info">
            <div class="panel-heading">Список сайтов
            </div>
            <div class="panel-body">
                <div ng-show="vm.sites && vm.sites.length>0" ui-tree data-drag-enabled="false">
                    <ol ui-tree-nodes ng-model="vm.sites">
                        <li ng-repeat="node in vm.sites" ui-tree-node collapsed="true"
                            ng-include="'partials/tree_template.html'"></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xs-8">
        <div class="panel panel-info ">
            <div class="panel-heading">Настройки</div>
            <div class="panel-body" ng-show="vm.site">
                <form>
                    <div class="form-group">
                        <label class="control-label">Выбранный сайт:</label>
                        <span ng-show="vm.site" style="word-wrap: break-word">{{vm.site.url}}</span>
                        <span ng-show="!vm.site">не выбран</span>
                    </div>

                    <div class="form-group">
                        <label class="control-label ">Ключевая фраза: </label>
                        <input type="text" ng-disabled="true" class="form-control "
                               ng-model="vm.site.condition_query">
                    </div>


                    <div class="form-group">
                        <label class="control-label">Поисковая система: </label>
                        <input type="text" ng-disabled="true" class="form-control "
                               ng-model="vm.site.sengine_name">
                    </div>

                    <div class="form-group">
                        <label class="control-label">Регион: </label>
                        <input type="text" ng-disabled="true" class="form-control "
                               ng-model="vm.site.region">
                    </div>

                    <div class="form-group">
                        <label class="control-label ">Размер выборки: </label>
                        <input type="text" ng-disabled="true" class="form-control"
                               ng-model="vm.site.size_search">

                    </div>
                </form>

                <br>
                <button type="button" class="btn btn-primary" ng-disabled="vm.loading" ng-show="vm.site "
                        ng-click="vm.getParams()">Получить данные
                </button>
                <a class="btn btn-success " ng-disabled="vm.loading" ng-show="vm.site" ng-click="vm.calcParams()">
                    <span class="glyphicon glyphicon-refresh"></span>
                </a>

            </div>

        </div>
        <div class="panel panel-info ">
            <div class="panel-heading">
                Параметры
            </div>
            <div class="panel-body">

                <accordion close-others="vm.oneAtATime">
                    <accordion-group ng-show="vm.params">
                        <accordion-heading>
                            Графики параметров
                        </accordion-heading>
                        <div class="form-group">
                            <label class="control-label col-sm-3">Ваш сайт занимает место:</label>
                            <span ng-show="vm.site.position!=null" style="word-wrap: break-word">{{vm.site.position}}</span>
                            <span ng-show="vm.site.position==null">не попал в выборку</span>
                        </div>

                        <br>
                        <select ng-model="chart" class="form-control"
                                style=" margin-left:50px; width: 300px"
                                ng-change="vm.values = vm.chart.values;" ng-options="p.key for p in vm.params | orderBy:'key'">

                                </select>
                        <nvd3-line-chart ng-show="vm.params"
                                         data="vm.values"
                                         width="590"
                                         height="350"
                                         showXAxis="true"
                                         showYAxis="true"
                                         tooltips="true"
                                         interactive="true"
                                >
                        </nvd3-line-chart>


                    </accordion-group>
                    <accordion-group ng-show="vm.params1">
                        <accordion-heading>
                            Параметры сайтов из выборки
                        </accordion-heading>

                        <select ng-model="vm.chart1" class="form-control" style="  width: 500px"
                                ng-change="vm.values1 = vm.chart1.params" ng-options="p as p.name for p in vm.params1 | orderBy:'position'"></select>
                        <br>

                        <div class="form-inline">
                            <label class="control-label">
                                Ссылка сайта:
                            </label>

                            <div class="link form-group">
                                <a ng-href="{{vm.chart1.url}}">{{vm.chart1.url}}</a>
                            </div>
                        </div>

                        <br>

                        <div class="form-inline">
                            <label class="control-label">
                                Ссылка поисковой выборки:
                            </label>

                            <div class="link form-group">
                                <a ng-href="{{vm.chart1.surl}}" style="">{{vm.chart1.surl}}</a>
                            </div>
                        </div>
                        <br>

                        <div class="form-inline">
                            <label class="control-label">
                                Позиция в выборке:
                            </label>

                            <div class="link form-group">
                                <a ng-href="{{vm.chart1.position}}" style="">{{vm.chart1.position}}</a>
                            </div>
                        </div>
                        <br>

                        <div class="panel panel-default panel-body">
                            <ul class="list-group">
                                <li class="list-group-item  panel-heading" ng-repeat="param in vm.values1 | orderBy:'ru_name':true"
                                    ng-include="'partials/params_template.html'">
                                </li>
                            </ul>
                        </div>

                    </accordion-group>
                </accordion>
            </div>
        </div>
    </div>
</div>
</div>
